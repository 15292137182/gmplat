<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div id="importUser" style="padding:22px 20px">
    <!--<el-col :span="24" style="text-align:center">-->
        <form id="fileUpload" action="" enctype="multipart/form-data" target="_self"
              method="post">
            <input id="excelFile" name="file" type="file"/>
            <!--<input type="button" value="提交" onclick="submitExcel()"/>-->
        </form>
    <!--</el-col>-->
    <el-row style="padding:40px 20px">
        <el-col :span="11" style="text-align:right">
            <el-button type="primary" size="small" @click.native="conformEvent">保存</el-button>
        </el-col>
        <el-col :span="11" style="text-align: left" :offset="2">
            <el-button type="primary" size="small" @click.native="cancel">取消</el-button>
        </el-col>
    </el-row>
</div>
<script>
    //导入确定版本接口
    var conVersion=serverPath + "/excel/excelUpload";

    var importUser=new Vue({
        el:'#importUser',
        data:{

        },
        methods:{
            conformEvent(){
                var excelFile = $("#excelFile").val();
                if (excelFile == '') {
                    alert("请选择需上传的文件!");
                    return false;
                }
                $("#fileUpload").attr('action',conVersion);
                /** 验证文件是否导入成功  */
                $("#fileUpload").ajaxForm(function (data) {
                    console.log(data);
                    if (data == "1") {
                        alert("提交成功！");
                    }
                });
                $("#fileUpload").submit();
            },
            cancel(){
                ibcpLayer.Close(divIndex);
            }
        }
    })
</script>
</body>
</html>