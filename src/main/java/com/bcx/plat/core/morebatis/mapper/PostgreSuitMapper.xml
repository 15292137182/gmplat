<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bcx.plat.core.morebatis.mapper.PostgreSuitMapper">

  <sql id="solveWhereCondition">
    <where>
      <foreach collection="translator.translate(where)" item="i">
        <choose>
          <when test="i instanceof com.bcx.plat.core.morebatis.cctv1.SqlSegment">
            ${@com.bcx.plat.core.utils.UtilsTool@camelToUnderline(i.segment)}
          </when>
          <when test="i instanceof java.util.Collection">
            <foreach collection="i" separator="," item="item" open="(" close=")">
              #{item}
            </foreach>
          </when>
          <when test="i instanceof com.bcx.plat.core.morebatis.phantom.AliasedColumn">
            <!--这个地方以后要把column解析搬走-->
            ${@com.bcx.plat.core.utils.UtilsTool@camelToUnderline(i.fieldSource)}
          </when>
          <otherwise>#{i}</otherwise>
        </choose>
      </foreach>
    </where>
  </sql>

  <select id="plainSelect" resultType="hashmap">
    <foreach collection="list" item="i">
      <choose>
        <!--<when test="i instanceof com.bcx.plat.core.morebatis.cctv1.SqlSegment">${@com.bcx.plat.core.utils.UtilsTool@camelToUnderline(i.segment)}</when>-->
        <when test="i instanceof com.bcx.plat.core.morebatis.cctv1.SqlSegment">${i.segment}</when>
        <when test="i instanceof java.util.Collection">
          <foreach collection="i" separator="," item="item" open="(" close=")">
            #{item}
          </foreach>
        </when>
        <otherwise>#{i}</otherwise>
      </choose>
    </foreach>
  </select>

  <delete id="plainDelete">
    <foreach collection="list" item="i">
      <choose>
        <!--<when test="i instanceof com.bcx.plat.core.morebatis.cctv1.SqlSegment">${@com.bcx.plat.core.utils.UtilsTool@camelToUnderline(i.segment)}</when>-->
        <when test="i instanceof com.bcx.plat.core.morebatis.cctv1.SqlSegment">${i.segment}</when>
        <when test="i instanceof java.util.Collection">
          <foreach collection="i" separator="," item="item" open="(" close=")">
            #{item}
          </foreach>
        </when>
        <otherwise>#{i}</otherwise>
      </choose>
    </foreach>
  </delete>

  <update id="plainUpdate">
    <foreach collection="list" item="i">
      <choose>
        <!--<when test="i instanceof com.bcx.plat.core.morebatis.cctv1.SqlSegment">${@com.bcx.plat.core.utils.UtilsTool@camelToUnderline(i.segment)}</when>-->
        <when test="i instanceof com.bcx.plat.core.morebatis.cctv1.SqlSegment">${i.segment}</when>
        <when test="i instanceof java.util.Collection">
          <foreach collection="i" separator="," item="item" open="(" close=")">
            #{item}
          </foreach>
        </when>
        <otherwise>#{i}</otherwise>
      </choose>
    </foreach>
  </update>

  <insert id="plainInsert">
    <foreach collection="list" item="i">
      <choose>
        <!--<when test="i instanceof com.bcx.plat.core.morebatis.cctv1.SqlSegment">${@com.bcx.plat.core.utils.UtilsTool@camelToUnderline(i.segment)}</when>-->
        <when test="i instanceof com.bcx.plat.core.morebatis.cctv1.SqlSegment">${i.segment}</when>
        <when test="i instanceof java.util.Collection">
          <foreach collection="i" separator="," item="item" open="(" close=")">
            #{item}
          </foreach>
        </when>
        <otherwise>#{i}</otherwise>
      </choose>
    </foreach>
  </insert>
</mapper>